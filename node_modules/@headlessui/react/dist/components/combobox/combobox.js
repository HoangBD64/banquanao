"use client";import{useFocusRing as Oe}from"@react-aria/focus";import{useHover as Ce}from"@react-aria/interactions";import{useVirtualizer as we}from"@tanstack/react-virtual";import L,{Fragment as ye,createContext as ce,createRef as Be,useCallback as Re,useContext as fe,useMemo as H,useReducer as ke,useRef as G,useState as Se}from"react";import{useActivePress as Ne}from'../../hooks/use-active-press.js';import{useByComparator as Ue}from'../../hooks/use-by-comparator.js';import{useControllable as He}from'../../hooks/use-controllable.js';import{useDefaultValue as Ge}from'../../hooks/use-default-value.js';import{useDisposables as Pe}from'../../hooks/use-disposables.js';import{useElementSize as Ie}from'../../hooks/use-element-size.js';import{useEvent as T}from'../../hooks/use-event.js';import{useFrameDebounce as je}from'../../hooks/use-frame-debounce.js';import{useId as le}from'../../hooks/use-id.js';import{useInertOthers as Ke}from'../../hooks/use-inert-others.js';import{useIsoMorphicEffect as K}from'../../hooks/use-iso-morphic-effect.js';import{useLatestValue as We}from'../../hooks/use-latest-value.js';import{useOnDisappear as ze}from'../../hooks/use-on-disappear.js';import{useOutsideClick as $e}from'../../hooks/use-outside-click.js';import{useOwnerDocument as Ae}from'../../hooks/use-owner.js';import{useRefocusableInput as Ee}from'../../hooks/use-refocusable-input.js';import{useResolveButtonType as Xe}from'../../hooks/use-resolve-button-type.js';import{useScrollLock as Je}from'../../hooks/use-scroll-lock.js';import{useSyncRefs as ue}from'../../hooks/use-sync-refs.js';import{useTrackedPointer as qe}from'../../hooks/use-tracked-pointer.js';import{useTreeWalker as Ye}from'../../hooks/use-tree-walker.js';import{useWatch as _e}from'../../hooks/use-watch.js';import{useDisabled as Qe}from'../../internal/disabled.js';import{FloatingProvider as Ze,useFloatingPanel as eo,useFloatingPanelProps as oo,useFloatingReference as to,useResolvedAnchor as no}from'../../internal/floating.js';import{FormFields as ro}from'../../internal/form-fields.js';import{useProvidedId as io}from'../../internal/id.js';import{OpenClosedProvider as ao,State as pe,useOpenClosed as lo}from'../../internal/open-closed.js';import{history as Fe}from'../../utils/active-element-history.js';import{isDisabledReactIssue7711 as uo}from'../../utils/bugs.js';import{Focus as S,calculateActiveIndex as he}from'../../utils/calculate-active-index.js';import{disposables as De}from'../../utils/disposables.js';import{sortByDomNode as po}from'../../utils/focus-management.js';import{match as Y}from'../../utils/match.js';import{isMobile as so}from'../../utils/platform.js';import{RenderFeatures as Me,forwardRefWithAs as Z,mergeProps as me,render as ee}from'../../utils/render.js';import{useDescribedBy as bo}from'../description/description.js';import{Keys as M}from'../keyboard.js';import{Label as co,useLabelledBy as xe,useLabels as fo}from'../label/label.js';import{MouseButton as Ve}from'../mouse.js';import{Portal as mo}from'../portal/portal.js';var xo=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(xo||{}),To=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(To||{}),go=(t=>(t[t.Pointer=0]="Pointer",t[t.Focus=1]="Focus",t[t.Other=2]="Other",t))(go||{}),vo=(i=>(i[i.OpenCombobox=0]="OpenCombobox",i[i.CloseCombobox=1]="CloseCombobox",i[i.GoToOption=2]="GoToOption",i[i.RegisterOption=3]="RegisterOption",i[i.UnregisterOption=4]="UnregisterOption",i[i.SetActivationTrigger=5]="SetActivationTrigger",i[i.UpdateVirtualConfiguration=6]="UpdateVirtualConfiguration",i))(vo||{});function Te(o,r=e=>e){let e=o.activeOptionIndex!==null?o.options[o.activeOptionIndex]:null,t=r(o.options.slice()),c=t.length>0&&t[0].dataRef.current.order!==null?t.sort((d,i)=>d.dataRef.current.order-i.dataRef.current.order):po(t,d=>d.dataRef.current.domRef.current),s=e?c.indexOf(e):null;return s===-1&&(s=null),{options:c,activeOptionIndex:s}}let Oo={[1](o){var r;return(r=o.dataRef.current)!=null&&r.disabled||o.comboboxState===1?o:{...o,activeOptionIndex:null,comboboxState:1,activationTrigger:2,__demoMode:!1}},[0](o){var r,e;if((r=o.dataRef.current)!=null&&r.disabled||o.comboboxState===0)return o;if((e=o.dataRef.current)!=null&&e.value){let t=o.dataRef.current.calculateIndex(o.dataRef.current.value);if(t!==-1)return{...o,activeOptionIndex:t,comboboxState:0,__demoMode:!1}}return{...o,comboboxState:0,__demoMode:!1}},[2](o,r){var s,d,i,m,n;if((s=o.dataRef.current)!=null&&s.disabled||(d=o.dataRef.current)!=null&&d.optionsRef.current&&!((i=o.dataRef.current)!=null&&i.optionsPropsRef.current.static)&&o.comboboxState===1)return o;if(o.virtual){let{options:p,disabled:f}=o.virtual,_=r.focus===S.Specific?r.idx:he(r,{resolveItems:()=>p,resolveActiveIndex:()=>{var u,x;return(x=(u=o.activeOptionIndex)!=null?u:p.findIndex(V=>!f(V)))!=null?x:null},resolveDisabled:f,resolveId(){throw new Error("Function not implemented.")}}),F=(m=r.trigger)!=null?m:2;return o.activeOptionIndex===_&&o.activationTrigger===F?o:{...o,activeOptionIndex:_,activationTrigger:F,__demoMode:!1}}let e=Te(o);if(e.activeOptionIndex===null){let p=e.options.findIndex(f=>!f.dataRef.current.disabled);p!==-1&&(e.activeOptionIndex=p)}let t=r.focus===S.Specific?r.idx:he(r,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:p=>p.id,resolveDisabled:p=>p.dataRef.current.disabled}),c=(n=r.trigger)!=null?n:2;return o.activeOptionIndex===t&&o.activationTrigger===c?o:{...o,...e,activeOptionIndex:t,activationTrigger:c,__demoMode:!1}},[3]:(o,r)=>{var s,d,i;if((s=o.dataRef.current)!=null&&s.virtual)return{...o,options:[...o.options,r.payload]};let e=r.payload,t=Te(o,m=>(m.push(e),m));o.activeOptionIndex===null&&(d=o.dataRef.current)!=null&&d.isSelected(r.payload.dataRef.current.value)&&(t.activeOptionIndex=t.options.indexOf(e));let c={...o,...t,activationTrigger:2};return(i=o.dataRef.current)!=null&&i.__demoMode&&o.dataRef.current.value===void 0&&(c.activeOptionIndex=0),c},[4]:(o,r)=>{var t;if((t=o.dataRef.current)!=null&&t.virtual)return{...o,options:o.options.filter(c=>c.id!==r.id)};let e=Te(o,c=>{let s=c.findIndex(d=>d.id===r.id);return s!==-1&&c.splice(s,1),c});return{...o,...e,activationTrigger:2}},[5]:(o,r)=>o.activationTrigger===r.trigger?o:{...o,activationTrigger:r.trigger},[6]:(o,r)=>{var t,c;if(o.virtual===null)return{...o,virtual:{options:r.options,disabled:(t=r.disabled)!=null?t:()=>!1}};if(o.virtual.options===r.options&&o.virtual.disabled===r.disabled)return o;let e=o.activeOptionIndex;if(o.activeOptionIndex!==null){let s=r.options.indexOf(o.virtual.options[o.activeOptionIndex]);s!==-1?e=s:e=null}return{...o,activeOptionIndex:e,virtual:{options:r.options,disabled:(c=r.disabled)!=null?c:()=>!1}}}},ge=ce(null);ge.displayName="ComboboxActionsContext";function oe(o){let r=fe(ge);if(r===null){let e=new Error(`<${o} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,oe),e}return r}let Le=ce(null);function Co(o){let r=Q("VirtualProvider"),{options:e}=r.virtual,[t,c]=H(()=>{let n=r.optionsRef.current;if(!n)return[0,0];let p=window.getComputedStyle(n);return[parseFloat(p.paddingBlockStart||p.paddingTop),parseFloat(p.paddingBlockEnd||p.paddingBottom)]},[r.optionsRef.current]),s=we({scrollPaddingStart:t,scrollPaddingEnd:c,count:e.length,estimateSize(){return 40},getScrollElement(){var n;return(n=r.optionsRef.current)!=null?n:null},overscan:12}),[d,i]=Se(0);K(()=>{i(n=>n+1)},[e]);let m=s.getVirtualItems();return m.length===0?null:L.createElement(Le.Provider,{value:s},L.createElement("div",{style:{position:"relative",width:"100%",height:`${s.getTotalSize()}px`},ref:n=>{if(n){if(typeof process!="undefined"&&process.env.JEST_WORKER_ID!==void 0||r.activationTrigger===0)return;r.activeOptionIndex!==null&&e.length>r.activeOptionIndex&&s.scrollToIndex(r.activeOptionIndex)}}},m.map(n=>{var p;return L.createElement(ye,{key:n.key},L.cloneElement((p=o.children)==null?void 0:p.call(o,{option:e[n.index],open:r.comboboxState===0}),{key:`${d}-${n.key}`,"data-index":n.index,"aria-setsize":e.length,"aria-posinset":n.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${n.start}px)`,overflowAnchor:"none"}}))})))}let se=ce(null);se.displayName="ComboboxDataContext";function Q(o){let r=fe(se);if(r===null){let e=new Error(`<${o} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,Q),e}return r}function yo(o,r){return Y(r.type,Oo,o,r)}let Ro=ye;function So(o,r){var D,U;let e=Qe(),{value:t,defaultValue:c,onChange:s,form:d,name:i,by:m,disabled:n=e||!1,onClose:p,__demoMode:f=!1,multiple:_=!1,immediate:F=!1,virtual:u=null,nullable:x,...V}=o,P=Ge(c),[C=_?[]:void 0,y]=He(t,s,P),[I,A]=ke(yo,{dataRef:Be(),comboboxState:f?0:1,options:[],virtual:u?{options:u.options,disabled:(D=u.disabled)!=null?D:()=>!1}:null,activeOptionIndex:null,activationTrigger:2,__demoMode:f}),h=G(!1),w=G({static:!1,hold:!1}),O=G(null),W=G(null),z=G(null),g=Ue(m),$=T(b=>u?m===null?u.options.indexOf(b):u.options.findIndex(v=>g(v,b)):I.options.findIndex(v=>g(v.dataRef.current.value,b))),X=Re(b=>Y(a.mode,{[1]:()=>C.some(v=>g(v,b)),[0]:()=>g(C,b)}),[C]),J=T(b=>I.activeOptionIndex===$(b)),a=H(()=>({...I,immediate:F,optionsPropsRef:w,inputRef:O,buttonRef:W,optionsRef:z,value:C,defaultValue:P,disabled:n,mode:_?1:0,virtual:u?I.virtual:null,get activeOptionIndex(){if(h.current&&I.activeOptionIndex===null&&(u?u.options.length>0:I.options.length>0)){if(u){let v=u.options.findIndex(N=>{var ae,ve;return!((ve=(ae=u.disabled)==null?void 0:ae.call(u,N))!=null&&ve)});if(v!==-1)return v}let b=I.options.findIndex(v=>!v.dataRef.current.disabled);if(b!==-1)return b}return I.activeOptionIndex},calculateIndex:$,compare:g,isSelected:X,isActive:J}),[C,P,n,_,f,I,u]);K(()=>{var b;u&&A({type:6,options:u.options,disabled:(b=u.disabled)!=null?b:null})},[u,u==null?void 0:u.options,u==null?void 0:u.disabled]),K(()=>{I.dataRef.current=a},[a]),$e([a.buttonRef,a.inputRef,a.optionsRef],()=>l.closeCombobox(),a.comboboxState===0);let j=H(()=>{var b,v,N;return{open:a.comboboxState===0,disabled:n,activeIndex:a.activeOptionIndex,activeOption:a.activeOptionIndex===null?null:a.virtual?a.virtual.options[(b=a.activeOptionIndex)!=null?b:0]:(N=(v=a.options[a.activeOptionIndex])==null?void 0:v.dataRef.current.value)!=null?N:null,value:C}},[a,n,C]),de=T(()=>{if(a.activeOptionIndex!==null){if(a.virtual)q(a.virtual.options[a.activeOptionIndex]);else{let{dataRef:b}=a.options[a.activeOptionIndex];q(b.current.value)}l.goToOption(S.Specific,a.activeOptionIndex)}}),be=T(()=>{A({type:0}),h.current=!0}),te=T(()=>{A({type:1}),h.current=!1,p==null||p()}),ne=T((b,v,N)=>(h.current=!1,b===S.Specific?A({type:2,focus:S.Specific,idx:v,trigger:N}):A({type:2,focus:b,trigger:N}))),re=T((b,v)=>(A({type:3,payload:{id:b,dataRef:v}}),()=>{a.isActive(v.current.value)&&(h.current=!0),A({type:4,id:b})})),q=T(b=>Y(a.mode,{[0](){return y==null?void 0:y(b)},[1](){let v=a.value.slice(),N=v.findIndex(ae=>g(ae,b));return N===-1?v.push(b):v.splice(N,1),y==null?void 0:y(v)}})),ie=T(b=>{A({type:5,trigger:b})}),l=H(()=>({onChange:q,registerOption:re,goToOption:ne,closeCombobox:te,openCombobox:be,setActivationTrigger:ie,selectActiveOption:de}),[]),[B,E]=fo(),k=r===null?{}:{ref:r},R=Re(()=>{if(P!==void 0)return y==null?void 0:y(P)},[y,P]);return L.createElement(E,{value:B,props:{htmlFor:(U=a.inputRef.current)==null?void 0:U.id},slot:{open:a.comboboxState===0,disabled:n}},L.createElement(Ze,null,L.createElement(ge.Provider,{value:l},L.createElement(se.Provider,{value:a},L.createElement(ao,{value:Y(a.comboboxState,{[0]:pe.Open,[1]:pe.Closed})},i!=null&&L.createElement(ro,{disabled:n,data:C!=null?{[i]:C}:{},form:d,onReset:R}),ee({ourProps:k,theirProps:V,slot:j,defaultTag:Ro,name:"Combobox"}))))))}let Po="input";function Io(o,r){var te,ne,re,q,ie;let e=Q("Combobox.Input"),t=oe("Combobox.Input"),c=le(),s=io(),{id:d=s||`headlessui-combobox-input-${c}`,onChange:i,displayValue:m,disabled:n=e.disabled||!1,autoFocus:p=!1,type:f="text",..._}=o,F=ue(e.inputRef,r,to()),u=Ae(e.inputRef),x=G(!1),V=Pe(),P=T(()=>{t.onChange(null),e.optionsRef.current&&(e.optionsRef.current.scrollTop=0),t.goToOption(S.Nothing)}),C=H(()=>{var l;return typeof m=="function"&&e.value!==void 0?(l=m(e.value))!=null?l:"":typeof e.value=="string"?e.value:""},[e.value,m]);_e(([l,B],[E,k])=>{if(x.current)return;let R=e.inputRef.current;R&&((k===0&&B===1||l!==E)&&(R.value=l),requestAnimationFrame(()=>{if(x.current||!R||(u==null?void 0:u.activeElement)!==R)return;let{selectionStart:D,selectionEnd:U}=R;Math.abs((U!=null?U:0)-(D!=null?D:0))===0&&D===0&&R.setSelectionRange(R.value.length,R.value.length)}))},[C,e.comboboxState,u]),_e(([l],[B])=>{if(l===0&&B===1){if(x.current)return;let E=e.inputRef.current;if(!E)return;let k=E.value,{selectionStart:R,selectionEnd:D,selectionDirection:U}=E;E.value="",E.value=k,U!==null?E.setSelectionRange(R,D,U):E.setSelectionRange(R,D)}},[e.comboboxState]);let y=G(!1),I=T(()=>{y.current=!0}),A=T(()=>{V.nextFrame(()=>{y.current=!1})}),h=je(),w=T(l=>{switch(x.current=!0,h(()=>{x.current=!1}),l.key){case M.Enter:if(x.current=!1,e.comboboxState!==0||y.current)return;if(l.preventDefault(),l.stopPropagation(),e.activeOptionIndex===null){t.closeCombobox();return}t.selectActiveOption(),e.mode===0&&t.closeCombobox();break;case M.ArrowDown:return x.current=!1,l.preventDefault(),l.stopPropagation(),Y(e.comboboxState,{[0]:()=>t.goToOption(S.Next),[1]:()=>t.openCombobox()});case M.ArrowUp:return x.current=!1,l.preventDefault(),l.stopPropagation(),Y(e.comboboxState,{[0]:()=>t.goToOption(S.Previous),[1]:()=>{t.openCombobox(),V.nextFrame(()=>{e.value||t.goToOption(S.Last)})}});case M.Home:if(l.shiftKey)break;return x.current=!1,l.preventDefault(),l.stopPropagation(),t.goToOption(S.First);case M.PageUp:return x.current=!1,l.preventDefault(),l.stopPropagation(),t.goToOption(S.First);case M.End:if(l.shiftKey)break;return x.current=!1,l.preventDefault(),l.stopPropagation(),t.goToOption(S.Last);case M.PageDown:return x.current=!1,l.preventDefault(),l.stopPropagation(),t.goToOption(S.Last);case M.Escape:return x.current=!1,e.comboboxState!==0?void 0:(l.preventDefault(),e.optionsRef.current&&!e.optionsPropsRef.current.static&&l.stopPropagation(),e.mode===0&&e.value===null&&P(),t.closeCombobox());case M.Tab:if(x.current=!1,e.comboboxState!==0)return;e.mode===0&&e.activationTrigger!==1&&t.selectActiveOption(),t.closeCombobox();break}}),O=T(l=>{i==null||i(l),e.mode===0&&l.target.value===""&&P(),t.openCombobox()}),W=T(l=>{var E,k,R;let B=(E=l.relatedTarget)!=null?E:Fe.find(D=>D!==l.currentTarget);if(x.current=!1,!((k=e.optionsRef.current)!=null&&k.contains(B))&&!((R=e.buttonRef.current)!=null&&R.contains(B))&&e.comboboxState===0)return l.preventDefault(),e.mode===0&&e.value===null&&P(),t.closeCombobox()}),z=T(l=>{var E,k,R;let B=(E=l.relatedTarget)!=null?E:Fe.find(D=>D!==l.currentTarget);(k=e.buttonRef.current)!=null&&k.contains(B)||(R=e.optionsRef.current)!=null&&R.contains(B)||e.disabled||e.immediate&&e.comboboxState!==0&&(t.openCombobox(),V.nextFrame(()=>{t.setActivationTrigger(1)}))}),g=xe(),$=bo(),{isFocused:X,focusProps:J}=Oe({autoFocus:p}),{isHovered:a,hoverProps:j}=Ce({isDisabled:n}),de=H(()=>({open:e.comboboxState===0,disabled:n,hover:a,focus:X,autofocus:p}),[e,a,X,p,n]),be=me({ref:F,id:d,role:"combobox",type:f,"aria-controls":(te=e.optionsRef.current)==null?void 0:te.id,"aria-expanded":e.comboboxState===0,"aria-activedescendant":e.activeOptionIndex===null?void 0:e.virtual?(ne=e.options.find(l=>!l.dataRef.current.disabled&&e.compare(l.dataRef.current.value,e.virtual.options[e.activeOptionIndex])))==null?void 0:ne.id:(re=e.options[e.activeOptionIndex])==null?void 0:re.id,"aria-labelledby":g,"aria-describedby":$,"aria-autocomplete":"list",defaultValue:(ie=(q=o.defaultValue)!=null?q:e.defaultValue!==void 0?m==null?void 0:m(e.defaultValue):null)!=null?ie:e.defaultValue,disabled:n||void 0,autoFocus:p,onCompositionStart:I,onCompositionEnd:A,onKeyDown:w,onChange:O,onFocus:z,onBlur:W},J,j);return ee({ourProps:be,theirProps:_,slot:de,defaultTag:Po,name:"Combobox.Input"})}let Ao="button";function Eo(o,r){var w;let e=Q("Combobox.Button"),t=oe("Combobox.Button"),c=ue(e.buttonRef,r),s=le(),{id:d=`headlessui-combobox-button-${s}`,disabled:i=e.disabled||!1,autoFocus:m=!1,...n}=o,p=Pe(),f=Ee(e.inputRef),_=T(O=>{switch(O.key){case M.Space:case M.Enter:return O.preventDefault(),O.stopPropagation(),e.comboboxState===1&&t.openCombobox(),p.nextFrame(()=>f());case M.ArrowDown:return O.preventDefault(),O.stopPropagation(),e.comboboxState===1&&(t.openCombobox(),p.nextFrame(()=>{e.value||t.goToOption(S.First)})),p.nextFrame(()=>f());case M.ArrowUp:return O.preventDefault(),O.stopPropagation(),e.comboboxState===1&&(t.openCombobox(),p.nextFrame(()=>{e.value||t.goToOption(S.Last)})),p.nextFrame(()=>f());case M.Escape:return e.comboboxState!==0?void 0:(O.preventDefault(),e.optionsRef.current&&!e.optionsPropsRef.current.static&&O.stopPropagation(),t.closeCombobox(),p.nextFrame(()=>f()));default:return}}),F=T(O=>{O.preventDefault(),!uo(O.currentTarget)&&(O.button===Ve.Left&&(e.comboboxState===0?t.closeCombobox():t.openCombobox()),f())}),u=xe([d]),{isFocusVisible:x,focusProps:V}=Oe({autoFocus:m}),{isHovered:P,hoverProps:C}=Ce({isDisabled:i}),{pressed:y,pressProps:I}=Ne({disabled:i}),A=H(()=>({open:e.comboboxState===0,active:y||e.comboboxState===0,disabled:i,value:e.value,hover:P,focus:x}),[e,P,x,y,i]),h=me({ref:c,id:d,type:Xe(o,e.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(w=e.optionsRef.current)==null?void 0:w.id,"aria-expanded":e.comboboxState===0,"aria-labelledby":u,disabled:i||void 0,autoFocus:m,onMouseDown:F,onKeyDown:_},V,C,I);return ee({ourProps:h,theirProps:n,slot:A,defaultTag:Ao,name:"Combobox.Button"})}let _o="div",Fo=Me.RenderStrategy|Me.Static;function ho(o,r){var z;let e=le(),{id:t=`headlessui-combobox-options-${e}`,hold:c=!1,anchor:s,portal:d=!1,modal:i=!0,...m}=o,n=Q("Combobox.Options"),p=oe("Combobox.Options"),f=no(s);f&&(d=!0);let[_,F]=eo(f),u=oo(),x=ue(n.optionsRef,r,f?_:null),V=Ae(n.optionsRef),P=lo(),C=(()=>P!==null?(P&pe.Open)===pe.Open:n.comboboxState===0)();ze(n.inputRef,p.closeCombobox,C),Je(V,n.__demoMode?!1:i&&n.comboboxState===0),Ke({allowed:T(()=>[n.inputRef.current,n.buttonRef.current,n.optionsRef.current])},n.__demoMode?!1:i&&n.comboboxState===0),K(()=>{var g;n.optionsPropsRef.current.static=(g=o.static)!=null?g:!1},[n.optionsPropsRef,o.static]),K(()=>{n.optionsPropsRef.current.hold=c},[n.optionsPropsRef,c]),Ye({container:n.optionsRef.current,enabled:n.comboboxState===0,accept(g){return g.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:g.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(g){g.setAttribute("role","none")}});let y=xe([(z=n.buttonRef.current)==null?void 0:z.id]),I=H(()=>({open:n.comboboxState===0,option:void 0}),[n]),A=T(()=>{p.setActivationTrigger(0)}),h=me(f?u():{},{"aria-labelledby":y,role:"listbox","aria-multiselectable":n.mode===1?!0:void 0,id:t,ref:x,style:{...F,"--input-width":Ie(n.inputRef,!0).width,"--button-width":Ie(n.buttonRef,!0).width},onWheel:A});n.virtual&&C&&Object.assign(m,{children:L.createElement(Co,null,m.children)});let[w,O]=Se(n.value);n.value!==w&&n.comboboxState===0&&n.mode!==1&&O(n.value);let W=T(g=>n.compare(w,g));return L.createElement(mo,{enabled:d?o.static||C:!1},L.createElement(se.Provider,{value:n.mode===1?n:{...n,isSelected:W}},ee({ourProps:h,theirProps:m,slot:I,defaultTag:_o,features:Fo,visible:C,name:"Combobox.Options"})))}let Do="div";function Mo(o,r){var g,$,X,J;let e=Q("Combobox.Option"),t=oe("Combobox.Option"),c=le(),{id:s=`headlessui-combobox-option-${c}`,value:d,disabled:i=(X=($=(g=e.virtual)==null?void 0:g.disabled)==null?void 0:$.call(g,d))!=null?X:!1,order:m=null,...n}=o,p=Ee(e.inputRef),f=e.virtual?e.activeOptionIndex===e.calculateIndex(d):e.activeOptionIndex===null?!1:((J=e.options[e.activeOptionIndex])==null?void 0:J.id)===s,_=e.isSelected(d),F=G(null),u=We({disabled:i,value:d,domRef:F,order:m}),x=fe(Le),V=ue(r,F,x?x.measureElement:null),P=T(()=>t.onChange(d));K(()=>t.registerOption(s,u),[u,s]);let C=G(!(e.virtual||e.__demoMode));K(()=>{if(!e.virtual&&!e.__demoMode)return De().requestAnimationFrame(()=>{C.current=!0})},[e.virtual,e.__demoMode]),K(()=>{if(C.current&&e.comboboxState===0&&f&&e.activationTrigger!==0)return De().requestAnimationFrame(()=>{var a,j;(j=(a=F.current)==null?void 0:a.scrollIntoView)==null||j.call(a,{block:"nearest"})})},[F,f,e.comboboxState,e.activationTrigger,e.activeOptionIndex]);let y=T(a=>{a.preventDefault(),a.button===Ve.Left&&(i||(P(),so()||requestAnimationFrame(()=>p()),e.mode===0&&t.closeCombobox()))}),I=T(()=>{if(i)return t.goToOption(S.Nothing);let a=e.calculateIndex(d);t.goToOption(S.Specific,a)}),A=qe(),h=T(a=>A.update(a)),w=T(a=>{if(!A.wasMoved(a)||i||f)return;let j=e.calculateIndex(d);t.goToOption(S.Specific,j,0)}),O=T(a=>{A.wasMoved(a)&&(i||f&&(e.optionsPropsRef.current.hold||t.goToOption(S.Nothing)))}),W=H(()=>({active:f,focus:f,selected:_,disabled:i}),[f,_,i]);return ee({ourProps:{id:s,ref:V,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":_,disabled:void 0,onMouseDown:y,onFocus:I,onPointerEnter:h,onMouseEnter:h,onPointerMove:w,onMouseMove:w,onPointerLeave:O,onMouseLeave:O},theirProps:n,slot:W,defaultTag:Do,name:"Combobox.Option"})}let Vo=Z(So),Lo=Z(Eo),wo=Z(Io),Bo=co,ko=Z(ho),No=Z(Mo),ht=Object.assign(Vo,{Input:wo,Button:Lo,Label:Bo,Options:ko,Option:No});export{ht as Combobox,Lo as ComboboxButton,wo as ComboboxInput,Bo as ComboboxLabel,No as ComboboxOption,ko as ComboboxOptions};
